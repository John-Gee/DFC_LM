function SwitchTokenLabel(){var t=my$("#OtherTokenValue").value;myMap("[name='OtherToken']",function(e){e.innerHTML=coinNameToImg(t)}),myMap("[name='OtherRatio']",function(e){e.innerHTML=coinNameToImg(t)}),my$("#xLabel").innerHTML="Final/Initial price of "+t+" in DFI, in %."}function formatCoin(e){if(!e.id)return e.text;var t=document.createElement("img");return t.src="../site/img/"+e.id+".svg",t.class="img-flag",t}function coinNameToImg(e){return'<img src="../site/img/'+e+'.svg" class="img-flag"/>&nbsp;'}function prettyNumber(e){return""==e?"":numbro(e).format({trimMantissa:!0,thousandSeparated:!0})}function cCalculate(){xCalculate("c")}function fCalculate(){xCalculate("f")}function xCalculate(e){calcPriceRatio(e),calculate()}function priceRatio(e){var t="#"+e+"PriceToken",i="#"+e+"PriceDFI";my$("#"+e+"PriceRatio").value?(my$(i).disabled=!0,my$(i).parentElement.classList.add("auto"),my$(t).disabled=!0,my$(t).parentElement.classList.add("auto")):(my$(i).disabled=!1,my$(i).parentElement.classList.remove("auto"),my$(t).disabled=!1,my$(t).parentElement.classList.remove("auto"))}function calcPriceRatio(e){var t="#"+e+"PriceToken",i="#"+e+"PriceDFI",e="#"+e+"PriceRatio";(my$(t).value||my$(i).value)&&(my$(e).disabled=!0,my$(e).parentElement.classList.add("auto"),my$(t).value&&my$(i).value)?my$(e).value=prettyNumber(my$(t).value/my$(i).value):my$(i).disabled||my$(i).disabled||(my$(e).value="")}function createTutorial(){return GuideChimp([{element:"#play",title:"Welcome to the tutorial! This button replays it."},{title:"This calculator estimates potential divergent changes."},{element:"#OtherTokenValueDiv",title:"Select the other coin.",position:"right"},{element:"#sync",title:"Get prices from CoinGecko.",position:"right"},{element:"#cPriceDFIDiv",title:"Enter DFI's initial price.",position:"right"},{element:"#cPriceTokenDiv",title:"Enter the other coin's initial price.",position:"right"},{element:"#cPriceRatioDiv",title:"Gives the other coin's initial price in DFI.",position:"right"},{element:"#finalPricesDiv",title:"Enter final prices.",position:"right"},{element:"#cAmountDFIDiv",title:"Enter the amount of DFI provided to the pool.",position:"right"},{element:"#cAmountTokenDiv",title:"The other coin's provided amount is automatically calculated.",position:"right"},{element:"#interestDiv",title:"This section is optional.",position:"top"},{element:"#aprDiv",title:"Enter the pool's rewards in APR.",position:"top"},{element:"#feeDiv",title:"Enter the pool's commissions in APR.",position:"top"},{element:"#durationDiv",title:"Enter days in liquidity mining.",position:"top"},{element:"#periodDiv",title:"Enter period in days to compound, the minimum is 0.0003472, apart from 0 which means no compounding. Beware of conversion and transaction fees.",position:"top"},{element:"#amountsParent",title:"Amounts of coins after liquidity mining",position:"bottom"},{element:"#initialValues",title:"Based on initial prices and amounts.",position:"bottom"},{element:"#holding",title:"Based on initial amounts and final prices.",position:"bottom"},{element:"#mining",title:"Based on final amounts and prices, without interest.",position:"bottom"},{element:"#miningI",title:"Based on final amounts and prices, with interest.",position:"bottom"},{element:"#plot",title:"This plots potential values, based on the other coin's final price in DFI.",position:"top"}],{padding:5})}function startTutorial(e){var t=localStorage.getItem("Tutorial-N");t?e.start(t):e.start(),localStorage.setItem("Tutorial","Started")}function compareValues(e,t,i,a){my$(a).parentElement.firstElementChild.classList.remove("minus"),my$(a).parentElement.firstElementChild.classList.remove("plus"),e==t||0==e||0==t||(t<e?my$(a).parentElement.firstElementChild.classList.add("minus"):my$(a).parentElement.firstElementChild.classList.add("plus"))}function compareTotalValues(e,t,i,a){var n;i&&(n="#cValue",(e=e)<t&&(n="#fValueH",e=t),e<i&&(n="#fValue",e=i),e<a&&(n="#fValueI",e=a),e&&(my$(n).parentElement.parentElement.classList.add("best"),my$(n).parentElement.parentElement.classList.remove("nonbest")))}function clearBest(e){my$(e).parentElement.parentElement.classList.remove("best"),my$(e).parentElement.parentElement.classList.add("nonbest")}function calculate(){var e,t,i,a,n,o,l=0,r=0,s=0,m=0,c=0,u=0,p=0,d=0,y=0,v=0,$=0,f=0,h=0,T=0,E=0,P=0,L=0,I=0,k=0,b=0;clearBest("#cValue"),clearBest("#fValueH"),clearBest("#fValue"),clearBest("#fValueI"),my$("#fAmounts").classList.add("shadow"),my$("#fAmountsI").classList.add("shadow"),my$("#initialValues").classList.add("shadow"),my$("#holding").classList.add("shadow"),my$("#mining").classList.add("shadow"),my$("#miningI").classList.add("shadow"),my$("#int").hidden=!0,createEmptyPlot(),(my$("#cPriceToken").value&&my$("#cPriceDFI").value||my$("#cPriceRatio").value)&&my$("#cAmountDFI").value&&(e=0,s=+my$("#cAmountDFI").value,my$("#cPriceToken").value&&my$("#cPriceDFI").value?e=(r=+my$("#cPriceToken").value)/(l=+my$("#cPriceDFI").value):my$("#cPriceRatio").value&&(e=+my$("#cPriceRatio").value),p=(u=(m=s/e)*r)+(c=s*l),t=+my$("#fPriceToken").value,i=+my$("#fPriceDFI").value,a=+my$("#fPriceRatio").value,my$("#fPriceToken").value&&my$("#fPriceDFI").value&&(a=t/i,i==l&&t==r&&(d=s,y=m)),my$("#initialValues").classList.remove("shadow"),a&&(y||d||(d=a*(y=Math.sqrt(m*s*1/a))),T=(h=y*t)+(f=d*i),b=(k=m*t)+(I=s*i),my$("#fAmounts").classList.remove("shadow"),my$("#holding").classList.remove("shadow"),my$("#mining").classList.remove("shadow"),(my$("#apr").value||my$("#fee").value)&&my$("#duration").value&&(o=+my$("#apr").value,n=+my$("#fee").value,l=+my$("#period").value,r=+my$("#duration").value,s=o/100,o=n/100,n=0,L=(P=($=l&&l<r?(n=365/(l=l<1/2880?1/2880:l),v=d+(d*((s=Math.pow(1+.9999*s/n,n)-1)+(o=Math.pow(1+.9999*o/n,n)-1))-3268e-7*n)*r/365,y+y*(s+o)*r/365):(v=d+d*(2*s+o)*r/365,y+y*o*r/365))*t)+(E=v*i),my$("#fAmountsI").classList.remove("shadow"),my$("#miningI").classList.remove("shadow")),createPlot(e,a,T,L,b))),my$("#cAmountToken").value=prettyNumber(m),my$("#cValueToken").value=prettyNumber(u),my$("#cValueDFI").value=prettyNumber(c),my$("#cValue").value=prettyNumber(p),my$("#fAmountToken").value=prettyNumber(y),my$("#fAmountDFI").value=prettyNumber(d),my$("#fAmountTokenI").value=prettyNumber($),my$("#fAmountDFII").value=prettyNumber(v),my$("#fValueToken").value=prettyNumber(h),my$("#fValueDFI").value=prettyNumber(f),my$("#fValue").value=prettyNumber(T),my$("#fValueTokenH").value=prettyNumber(k),my$("#fValueDFIH").value=prettyNumber(I),my$("#fValueH").value=prettyNumber(b),compareValues(I,f,"#fValueDFIH","#fValueDFI"),compareValues(k,h,"#fValueTokenH","#fValueToken"),compareValues(b,T,"#fValueH","#fValue"),my$("#fValueTokenI").value=prettyNumber(P),my$("#fValueDFII").value=prettyNumber(E),my$("#fValueI").value=prettyNumber(L),compareValues(I,E,"#fValueDFIH","#fValueDFII"),compareValues(k,P,"#fValueTokenH","#fValueTokenI"),compareValues(b,L,"#fValueH","#fValueI"),compareTotalValues(p,b,T,L)}function compareNumbers(e,t){return e-t}function createEmptyPlot(){new Chartist.Line(".ct-chart",{labels:[0,25,50,100,125,150,175,200],series:[[]]},{high:100,low:-100})}function createPlot(e,t,i,a,n){e=Math.round(t/e*100);if(priceRatios=[],points=[],points2=[],e<500)for(let e=0;e<11;e++)priceRatios.push(50*e);else{var o=Math.round(2*e/11);for(let e=0;e<11;e++)priceRatios.push(o*e);priceRatios.push(e)}priceRatios.push(e),priceRatios=[...new Set(priceRatios)].sort(compareNumbers);for(let e=0;e<priceRatios.length;e++)points.push(100*(2*Math.sqrt(priceRatios[e]/100)/(1+priceRatios[e]/100)-1));if(a){my$("#int").hidden=!1,interest_ratio=a/i;for(let e=0;e<priceRatios.length;e++)points2.push(100*(2*interest_ratio*Math.sqrt(priceRatios[e]/100)/(1+priceRatios[e]/100)-1))}priceRatios[priceRatios.indexOf(e)]=e+" (from input)",new Chartist.Line(".ct-chart",{labels:priceRatios,series:[points,points2]},{high:Math.max.apply(null,points.concat(points2)),low:-100,showArea:!0,plugins:[Chartist.plugins.ctThreshold({threshold:0})]})}function getPrices(){my$("#sync").classList.add("rotate");var t="defichain",i=my$("#OtherTokenValue").options[my$("#OtherTokenValue").selectedIndex].innerHTML.toLowerCase();fetch("https://api.coingecko.com/api/v3/simple/price?ids="+t+"%2C"+i+"&vs_currencies=usd").then(e=>e.json()).then(function(e){my$("#cPriceDFI").value=e[t].usd,inputEvent("#cPriceDFI"),"tether"!=i&&(my$("#cPriceToken").value=e[i].usd,inputEvent("#cPriceToken")),my$("#sync").classList.remove("rotate")}).catch(function(e){my$("#sync").classList.remove("rotate")})}function WindowResize(){isNumbersWrapped()?my$("#verticalHR").hidden=!0:my$("#verticalHR").hidden=!1}function isNumbersWrapped(){return my$("#values").getBoundingClientRect().top>my$("#amounts").getBoundingClientRect().top}function inputEvent(e){my$(e).dispatchEvent(new Event("input"))}function myMap(e,t){return Array.prototype.map.call(document.querySelectorAll(e),t)}function my$(e){return document.querySelector(e)}document.addEventListener("DOMContentLoaded",function(){my$("#OtherTokenValue").addEventListener("input",function(){SwitchTokenLabel(),"USDT"==my$("#OtherTokenValue").value?(my$("#cPriceToken").value=1,inputEvent("#cPriceToken"),my$("#cPriceToken").disabled=!0,my$("#cPriceToken").parentElement.classList.add("auto"),my$("#fPriceToken").value=1,inputEvent("#fPriceToken"),my$("#fPriceToken").disabled=!0,my$("#fPriceToken").parentElement.classList.add("auto")):(my$("#cPriceToken").value="",inputEvent("#cPriceToken"),my$("#fPriceToken").value="",inputEvent("#fPriceToken"),my$("#cPriceDFI").disabled||(my$("#cPriceToken").disabled=!1,my$("#cPriceToken").parentElement.classList.remove("auto")),my$("#fPriceDFI").disabled||(my$("#fPriceToken").disabled=!1,my$("#fPriceToken").parentElement.classList.remove("auto")))}),SwitchTokenLabel(),new TsSelect2(my$("#OtherTokenValue"),{minimumResultsForSearch:-1,width:"100%",dropdownAutoWidth:!0,templateResult:formatCoin,templateSelection:formatCoin,escapeMarkup:function(e){return e}}),window.addEventListener("resize",WindowResize),WindowResize(),my$("#cPriceToken").addEventListener("input",cCalculate),my$("#cPriceDFI").addEventListener("input",cCalculate),my$("#cAmountDFI").addEventListener("input",calculate),my$("#fPriceToken").addEventListener("input",fCalculate),my$("#fPriceDFI").addEventListener("input",fCalculate),my$("#apr").addEventListener("input",calculate),my$("#fee").addEventListener("input",calculate),my$("#duration").addEventListener("input",calculate),my$("#period").addEventListener("input",calculate),my$("#period").addEventListener("input",calculate),my$("#sync").addEventListener("click",getPrices),createEmptyPlot();var e=createTutorial();e.on("onStop",()=>{localStorage.setItem("Tutorial-N",e.currentStepIndex)}),e.on("onComplete",()=>{localStorage.removeItem("Tutorial-N")}),my$("#play").addEventListener("mouseover",function(){my$("#play").style.display="none",my$("#play2").style.display="block"}),my$("#play").addEventListener("mouseout",function(){my$("#play").style.display="block",my$("#play2").style.display="none"}),my$("#playButtons").addEventListener("click",function(){startTutorial(e)}),"Started"!=localStorage.getItem("Tutorial")&&startTutorial(e)});
//# sourceMappingURL=functions.js.min.map